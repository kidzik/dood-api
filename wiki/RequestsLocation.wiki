#summary One-sentence summary of this page.

= Location requests=

Content:
   * [RequestsLocation#Location_Set Location Set]

== Location Set =

|| request URL || *(HTTPS)* `/location/set/` || 
|| method || *POST* ||
|| description || Logins user and starts authenticated session ||

<font color="red"> _warning: currently we support HTTP and GET method in this request_ </font>

*Prameters:*
|| *parameter* || *type* || *description* ||
|| `session_key` || `String` || User's session key (anonymous or authenticated)  ||
|| `latitude` || `Double` || User's current latitude  ||
|| `longtitude` || `Double` || User's current longtitude ||
|| `default_city` || `String` || Default city if coordinates are wrong or too far away from any database entry ||
|| _`get_advert`_ || `Boolean` || True if AdvertProximity object requested. ||
|| _`only_open`_ || `Boolean` || User's current longtitude. Make sense only with _`get_advert`_="true"||
|| `categories` || `List<Long>` || CSV with IDs of categories. Make sense only with _`get_advert`_="true" ||

*Returns HTTP code*

|| *HTTP code* || *meaning*||
|| 200 || server understood request || 
|| 401 || session_key not present or expired ||
|| any other || server unreachable, unable to respond ||

*Returns API code (for HTTP code 200)*

|| *API CODE* || *meaning* ||
|| MSG_OK || new location has been set ||
|| ERR_REGION_NOT_SUPPORTED || coordinates are to far from any database entry. `default_city` parameter has been considered. || 


*Returns data (for MSG_OK)*
{{{
{
   "code" : 0x000000
   "data" : [{<AdvertProximity>; {<Business>} ; {<Business>} ...]
}
}}}

_warning: data array can be empty (but data field should be present)._

  * Pole `get_advert` definiuje czy klient chce w odpowiedzi dostać obiekt [DatatypesAdvertProximity Proximity Advertisement]. Serwer decyduje o tym co przesłać klientowi. Klient biernie wyświetla dane przychodzące od serwera.

  * Dane przesłane przez serwer mogą nie zawierać obiektu Proximity Advertisemenet a jedynie obiekty typu [DatatypesBusiness Business]. W takim wypadku serwer uznał, że w okolicy nie ma żadnych ofert do pokazania i po prostu przesyła wybrane (wg ewentualnych ograniczeń) dane businessów (klient może je pokazać lub nie).

  * Pola `only_open`, `categories` nie mają sensu jeśli nie ma flagi `get_advert=true`.

  * W pierwszej wersji implementacji API w polu data w przypadku ustawienia flagi get_advert zwracane są zawsze elementy [DatatypesAdvertProximity Proximity Advertisement] oraz wszystkie obiekty [DatatypesBusiness Business] z listy. 